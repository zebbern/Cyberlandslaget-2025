
# Futuristic Malware

**Challenge Prompt:**

> I gave you modern malware https://github.com/olnor18/writeup/tree/master/DDC/2024/ModernMalware.  
> How do you like some futuristic malware???

**Files provided:**  
- `invoice.pdf.DMP.exe`  
- `invoice.pdf.exe`  
- `capture.pcapng`

---

## 🧠 Initial Thoughts

From the files provided, the challenge likely involves:
- Extracting data from the memory dump
- Analyzing traffic from the Wireshark capture
- Reverse engineering the malware binary

---

## 🔍 First Steps

Used `strings` and `binwalk` for a quick overview:

```bash
strings file.ext > file.ext.txt
binwalk -e file.ext
```

Also ran `AESKeyFind` on the memory dump — found a few AES keys (as in previous forensics challenges).

---

## 🔬 Reversing

Used **Detect It Easy** — identified the binary is written in **Go**.

Opened it in **IDA Pro** which works well with Golang binaries.

Discovered:
- Payloads are base64 encoded
- Then encrypted with AES CBC

Snippet showing decryption logic:

```c
v18 = encoding_base64__ptr_Encoding_DecodeString(encoding_base64_StdEncoding, a1, a2);
...
crypto_sha256_Sum256(v5);
...
v6 = crypto_aes_NewCipher(v14, 32LL, 32LL);
v7 = crypto_cipher_NewCBCDecrypter(v6, 32LL, p__16_uint8, 16LL, 16LL);
```

---

## 🧠 Dump Analysis

Saw base64 strings in the memory dump — likely data sent by the malware.

Copied a short base64 string and decrypted it using extracted AES keys.  
Result: it worked, but lacked the IV, so first block was incorrect.

Solution:  
- Found plaintext version in memory
- XORed encrypted vs plaintext → derived IV  
- (Classic CBC weakness when plaintext is known)

---

## 🧂 Base64 Padding Trick

Some base64 strings failed to decode — likely due to missing padding.

By manually padding the base64 strings (`=`, `==`), was able to decode more values.

---

## 🧀 Cheese?

Eventually, one padded base64 string revealed the flag:

```
"Root","Flag","","DDC{g0d_1_h4t3_http3_m4tur1ty}","","","","0","2024-08-12T10:14:05Z","2024-08-12T10:12:46Z"
```

---

## 🕵️ Post-Solve Thoughts

Examined the `capture.pcapng` file — found QUIC protocol in use.

Possibly intended solution:
- Extract session keys from memory
- Decrypt QUIC payloads from capture

But since the AES keys were enough to decrypt in-memory payloads, that shortcut worked.

---

## 🏁 Flag

```
DDC{g0d_1_h4t3_http3_m4tur1ty}
```
